"0","#calculate the total mean of every aspects"
"0","aspect_mean_score <- df %>% "
"0","  summarize("
"0","    services = mean(mean_services_score, na.rm= TRUE),"
"0","    cleanliness = mean(mean_cleanliness_score, na.rm= TRUE),"
"0","    product = mean(mean_product_score, na.rm= TRUE),"
"0","  )"
"0",""
"0","#turn the ""means"" to long format"
"0","aspect_mean_score_long <- pivot_longer(aspect_mean_score, everything(), names_to = ""Aspect"", values_to = ""mean_score"")"
"0",""
"0","#binning to tell the color identity"
"0","aspect_mean_score_long <- aspect_mean_score_long %>% "
"0","  mutate("
"0","    Performance = case_when("
"0","      mean_score > 4 ~ ""Good"","
"0","      mean_score >= 3.9 ~ ""Medium"","
"0","      TRUE ~ ""Needs Improvement"""
"0","    )"
"0","  )"
"0",""
"0","#make a color scheme"
"0","peformance_ttl_mean_scheme <- c("
"0","  ""Needs Improvement"" = ""#FF9D23"","
"0","  ""Medium"" = ""#B4E50D"","
"0","  ""Good"" = ""#78C841"""
"0",") "
"0",""
"0","plot_peformance_ttl_mean <- ggplot(aspect_mean_score_long, aes(x = Aspect, y = mean_score, fill = Performance))+"
"0","  geom_bar(stat = ""identity"", width = 0.6)+"
"0","  geom_text(aes(label = round(mean_score, 2)), vjust = -0.5, size = 4)+"
"0","  labs("
"0","    title = ""Total Average Canteen Score per Aspect"","
"0","    x = ""Aspects"","
"0","    y = ""Mean Score"""
"0","  )+"
"0","  ylim(0, 5) +"
"0","  scale_fill_manual(values = peformance_ttl_mean_scheme)+"
"0","  theme_minimal()"
"0",""
"0","#show(plot_peformance_ttl_mean)"
"0","ggplotly(plot_peformance_ttl_mean)"

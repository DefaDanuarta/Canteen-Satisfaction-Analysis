"0","#duplicate the df to new dataframe focusin on mean score per major"
"0","mean_satisfaction_major <- df %>%"
"0","  group_by(major_group) %>%"
"0","  summarise("
"0","    responses = n(),"
"0","    services_score = mean(mean_services_score) %>% round(digits = 3),"
"0","    service_sd = df %>% select(all_of(cols_services)) %>% rowMeans(na.rm = TRUE) %>% sd(na.rm = TRUE) %>% round(3),"
"0","    "
"0","    cleanliness_score = mean(mean_cleanliness_score) %>% round(digits = 3),"
"0","    cleanliness_sd = df %>% select(all_of(cols_cleanliness)) %>% rowMeans(na.rm = TRUE) %>% sd(na.rm = TRUE) %>% round(3),"
"0","    "
"0","    product_score = mean(mean_product_score) %>% round(digits = 3),"
"0","    product_sd = df %>% select(all_of(cols_product)) %>% rowMeans(na.rm = TRUE) %>% sd(na.rm = TRUE) %>% round(3),"
"0","    "
"0","    overall_score = mean(mean_satisfaction_score) %>% round(digits = 3)"
"0","    )"
"0",""
"0","#make the df to long format"
"0","long_mean_satisfaction_major <- mean_satisfaction_major %>%"
"0","  pivot_longer(cols = c(services_score, cleanliness_score, product_score), names_to = ""aspect"", values_to = ""score"")"
"0",""
"0","#Binning the score"
"0","long_mean_satisfaction_major <- long_mean_satisfaction_major %>% mutate("
"0","  category = case_when("
"0","     score > 4 ~ ""Exellent"","
"0","     score >= 3.9 ~ ""Good"","
"0","     TRUE ~ ""Needs Improvement"""
"0","  )"
"0",")"

"0","#each of the variables name is already declared"
"0",""
"0","#make a long df to combine the multiple column to an each identical column per aspects"
"0","df_long_stats <- df %>% "
"0","  select(all_of(c(cols_services, cols_cleanliness, cols_product))) %>%"
"0","  pivot_longer(cols = everything(),"
"0","               names_to = ""variable"","
"0","               values_to = ""score"") %>%"
"0","  mutate(aspect = case_when("
"0","    variable %in% cols_services ~ ""service"","
"0","    variable %in% cols_cleanliness ~ ""cleanliness"","
"0","    variable %in% cols_product ~ ""product"""
"0","  ))"
"0",""
"0","#count the stats"
"0","df_stats <- df_long_stats %>% group_by(aspect, variable) %>%"
"0","  summarise("
"0","    #I'll round the result to handle the numbers with ease"
"0","    mean = mean(score, na.rm = TRUE) %>% round(digits = 4),"
"0","    median = median(score, na.rm = TRUE),"
"0","    sd = sd(score, na.rm = TRUE) %>% round(digits = 4),"
"0","    max = max(score, na.rm = TRUE),"
"0","    min = min(score, na.rm = TRUE)"
"0","  )"
"0",""
"0","#binning"
"0","df_stats <- df_stats %>% mutate("
"0","  category = case_when("
"0","    mean < 3.5 ~ ""Needs Improvement"","
"0","    mean < 4 ~ ""Medium"","
"0","    TRUE ~ ""Good"""
"0","  )"
"0",")"
